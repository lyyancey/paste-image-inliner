<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ¼å¼ä¿æŒæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .copy-area {
            border: 2px solid #1890ff;
            background: #e6f7ff;
            padding: 20px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .paste-area {
            border: 2px dashed #52c41a;
            background: #f6ffed;
            padding: 20px;
            min-height: 150px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .btn {
            background: #1890ff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #40a9ff; }
        
        /* æµ‹è¯•æ ·å¼ */
        .large-text { font-size: 24px; }
        .medium-text { font-size: 18px; }
        .small-text { font-size: 12px; }
        .red-text { color: #ff4d4f; }
        .blue-text { color: #1890ff; }
        .green-text { color: #52c41a; }
        .bold-text { font-weight: bold; }
        .italic-text { font-style: italic; }
        .underline-text { text-decoration: underline; }
        .highlight-bg { background-color: #fff2e6; }
        .serif-font { font-family: 'Times New Roman', serif; }
        .mono-font { font-family: 'Courier New', monospace; }
        .custom-style {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #ff69b4;
            color: #8b0000;
            font-weight: bold;
        }
        
        h1 { color: #722ed1; font-size: 28px; }
        h2 { color: #fa541c; font-size: 22px; }
        h3 { color: #13c2c2; font-size: 18px; }
        
        .styled-image {
            border: 3px solid #ff7875;
            border-radius: 10px;
            padding: 5px;
            background: #fff1f0;
            margin: 10px;
        }
        
        .image-caption {
            font-size: 12px;
            color: #666;
            font-style: italic;
            text-align: center;
            margin-top: 5px;
        }
        
        .complex-layout {
            display: flex;
            gap: 20px;
            align-items: center;
            background: #f0f2f5;
            padding: 15px;
            border-radius: 8px;
        }
        
        .text-block {
            flex: 1;
        }
        
        .image-block {
            flex: 0 0 auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ æ ¼å¼ä¿æŒæµ‹è¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>ğŸ“ æµ‹è¯•1ï¼šåŸºç¡€æ–‡å­—æ ¼å¼</h2>
        <p>é€‰æ‹©ä¸‹é¢çš„å†…å®¹è¿›è¡Œå¤åˆ¶æµ‹è¯•ï¼š</p>
        <div class="copy-area" id="basicFormat">
            <h1>è¿™æ˜¯ä¸€çº§æ ‡é¢˜</h1>
            <h2>è¿™æ˜¯äºŒçº§æ ‡é¢˜</h2>
            <h3>è¿™æ˜¯ä¸‰çº§æ ‡é¢˜</h3>
            <p class="large-text red-text bold-text">å¤§å·çº¢è‰²ç²—ä½“æ–‡å­—</p>
            <p class="medium-text blue-text italic-text">ä¸­å·è“è‰²æ–œä½“æ–‡å­—</p>
            <p class="small-text green-text underline-text">å°å·ç»¿è‰²ä¸‹åˆ’çº¿æ–‡å­—</p>
            <p class="highlight-bg serif-font">é«˜äº®èƒŒæ™¯ + è¡¬çº¿å­—ä½“</p>
            <p class="mono-font">ç­‰å®½å­—ä½“æ–‡æœ¬ - Monospace Font</p>
            <div class="custom-style">è‡ªå®šä¹‰å¤æ‚æ ·å¼æ–‡æœ¬å—</div>
        </div>
        
        <button class="btn" onclick="copyContent('basicFormat')">å¤åˆ¶åŸºç¡€æ ¼å¼</button>
        
        <h3>ç²˜è´´åŒºåŸŸï¼š</h3>
        <div class="paste-area" contenteditable="true" id="pasteBasic">
            ç‚¹å‡»è¿™é‡Œï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´...
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ–¼ï¸ æµ‹è¯•2ï¼šå›¾ç‰‡ + æ ¼å¼æ··åˆ</h2>
        <p>é€‰æ‹©ä¸‹é¢åŒ…å«å›¾ç‰‡å’Œæ ¼å¼çš„å†…å®¹ï¼š</p>
        <div class="copy-area" id="mixedContent">
            <h2 class="red-text">åŒ…å«å›¾ç‰‡çš„æ ¼å¼åŒ–å†…å®¹</h2>
            <p class="large-text blue-text">è¿™æ˜¯<strong class="bold-text">ç²—ä½“</strong>å’Œ<em class="italic-text">æ–œä½“</em>æ··åˆçš„æ–‡å­—ã€‚</p>
            
            <div class="complex-layout">
                <div class="text-block">
                    <h3 class="green-text">å·¦ä¾§æ–‡æœ¬å—</h3>
                    <p class="medium-text">è¿™æ®µæ–‡å­—åŒ…å«<span class="highlight-bg underline-text">é«˜äº®ä¸‹åˆ’çº¿</span>æ•ˆæœã€‚</p>
                </div>
                <div class="image-block">
                    <img src="https://via.placeholder.com/100x80/ff6b6b/ffffff?text=æ ¼å¼æµ‹è¯•1" 
                         alt="æµ‹è¯•å›¾ç‰‡1" class="styled-image">
                    <div class="image-caption">å›¾ç‰‡è¯´æ˜æ–‡å­—</div>
                </div>
            </div>
            
            <p class="serif-font large-text">è¿™é‡Œæœ‰æ›´å¤šå›¾ç‰‡ï¼š</p>
            <img src="https://via.placeholder.com/80x60/4ecdc4/ffffff?text=TEST2" alt="æµ‹è¯•å›¾ç‰‡2" class="styled-image">
            <img src="https://via.placeholder.com/80x60/45b7d1/ffffff?text=TEST3" alt="æµ‹è¯•å›¾ç‰‡3" class="styled-image">
            
            <div class="custom-style">
                <p class="bold-text">å¤æ‚æ ·å¼å—å†…çš„å†…å®¹</p>
                <img src="https://via.placeholder.com/60x60/f39c12/ffffff?text=å†…åµŒ" alt="å†…åµŒå›¾ç‰‡">
            </div>
        </div>
        
        <button class="btn" onclick="copyContent('mixedContent')">å¤åˆ¶æ··åˆå†…å®¹</button>
        
        <h3>ç²˜è´´åŒºåŸŸï¼š</h3>
        <div class="paste-area" contenteditable="true" id="pasteMixed">
            ç‚¹å‡»è¿™é‡Œï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´...
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š æµ‹è¯•3ï¼šè¡¨æ ¼å’Œåˆ—è¡¨æ ¼å¼</h2>
        <div class="copy-area" id="structuredContent">
            <h3 class="blue-text">ç»“æ„åŒ–å†…å®¹æµ‹è¯•</h3>
            
            <ul style="color: #722ed1; font-weight: bold;">
                <li class="large-text">ç¬¬ä¸€é¡¹ - <span class="red-text">çº¢è‰²æ–‡å­—</span></li>
                <li class="medium-text">ç¬¬äºŒé¡¹ - <span class="green-text underline-text">ç»¿è‰²ä¸‹åˆ’çº¿</span></li>
                <li class="small-text">ç¬¬ä¸‰é¡¹ - <img src="https://via.placeholder.com/30x30/e74c3c/ffffff?text=å°å›¾" alt="å°å›¾æ ‡" style="vertical-align: middle;"> å†…è”å›¾ç‰‡</li>
            </ul>
            
            <table style="border-collapse: collapse; width: 100%; margin: 15px 0;">
                <caption style="font-size: 18px; color: #722ed1; font-weight: bold; margin-bottom: 10px; text-align: left; caption-side: top;">
                    ğŸ“‹ æµ‹è¯•æ•°æ®è¡¨æ ¼æ ‡é¢˜
                </caption>
                <tr style="background: #f0f2f5;">
                    <th style="border: 1px solid #d9d9d9; padding: 8px; color: #1890ff;">åˆ—1</th>
                    <th style="border: 1px solid #d9d9d9; padding: 8px; color: #1890ff;">åˆ—2</th>
                    <th style="border: 1px solid #d9d9d9; padding: 8px; color: #1890ff;">å›¾ç‰‡åˆ—</th>
                </tr>
                <tr>
                    <td style="border: 1px solid #d9d9d9; padding: 8px; color: #722ed1; font-weight: bold;">æ•°æ®1</td>
                    <td style="border: 1px solid #d9d9d9; padding: 8px; color: #fa541c; font-style: italic;">æ•°æ®2</td>
                    <td style="border: 1px solid #d9d9d9; padding: 8px; text-align: center;">
                        <img src="https://via.placeholder.com/40x40/52c41a/ffffff?text=è¡¨æ ¼" alt="è¡¨æ ¼å›¾ç‰‡">
                    </td>
                </tr>
            </table>
            
            <table style="border-collapse: collapse; width: 100%; margin: 15px 0; border: 2px solid #ff7875;">
                <caption style="font-size: 16px; color: #ff4d4f; font-style: italic; margin-bottom: 8px; text-align: center; caption-side: top; background: #fff1f0; padding: 5px; border-radius: 4px;">
                    ğŸ–¼ï¸ å¸¦å›¾ç‰‡çš„è¡¨æ ¼ - ç¬¬äºŒä¸ªæµ‹è¯•è¡¨
                </caption>
                <tr style="background: #fff7e6;">
                    <th style="border: 1px solid #ffadd6; padding: 10px; color: #d46b08;">åç§°</th>
                    <th style="border: 1px solid #ffadd6; padding: 10px; color: #d46b08;">å›¾ç‰‡</th>
                    <th style="border: 1px solid #ffadd6; padding: 10px; color: #d46b08;">æè¿°</th>
                </tr>
                <tr>
                    <td style="border: 1px solid #ffadd6; padding: 10px; color: #722ed1;">ç¤ºä¾‹é¡¹ç›®</td>
                    <td style="border: 1px solid #ffadd6; padding: 10px; text-align: center;">
                        <img src="https://via.placeholder.com/50x50/fa541c/ffffff?text=æ ·ä¾‹" alt="æ ·ä¾‹å›¾ç‰‡" style="border-radius: 50%;">
                    </td>
                    <td style="border: 1px solid #ffadd6; padding: 10px; color: #13c2c2; font-style: italic;">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æè¿°</td>
                </tr>
            </table>
        </div>
        
        <button class="btn" onclick="copyContent('structuredContent')">å¤åˆ¶ç»“æ„åŒ–å†…å®¹</button>
        
        <h3>ç²˜è´´åŒºåŸŸï¼š</h3>
        <div class="paste-area" contenteditable="true" id="pasteStructured">
            ç‚¹å‡»è¿™é‡Œï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´...
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“„ æµ‹è¯•4ï¼šä¸“é—¨çš„è¡¨æ ¼æ ‡é¢˜æµ‹è¯•</h2>
        <div class="copy-area" id="captionTest">
            <h3 class="green-text">è¡¨æ ¼æ ‡é¢˜ä¸“é¡¹æµ‹è¯•</h3>
            <p>ä¸‹é¢æ˜¯å‡ ä¸ªä¸åŒæ ·å¼çš„è¡¨æ ¼æ ‡é¢˜ï¼š</p>
            
            <table style="border: 1px solid #000; margin: 10px 0; width: 100%;">
                <caption style="color: #ff4d4f; font-size: 20px; font-weight: bold; caption-side: top; margin-bottom: 10px;">
                    é¡¶éƒ¨æ ‡é¢˜ - çº¢è‰²ç²—ä½“å¤§å­—
                </caption>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px;">å•å…ƒæ ¼1</td>
                    <td style="border: 1px solid #ccc; padding: 8px;">å•å…ƒæ ¼2</td>
                </tr>
            </table>
            
            <table style="border: 1px solid #000; margin: 10px 0; width: 100%;">
                <caption style="color: #1890ff; font-size: 14px; font-style: italic; caption-side: bottom; margin-top: 10px; text-align: right;">
                    åº•éƒ¨æ ‡é¢˜ - è“è‰²æ–œä½“å³å¯¹é½
                </caption>
                <tr>
                    <td style="border: 1px solid #ccc; padding: 8px;">æ•°æ®A</td>
                    <td style="border: 1px solid #ccc; padding: 8px;">
                        <img src="https://via.placeholder.com/30x30/52c41a/ffffff?text=C" alt="è¡¨æ ¼å†…å›¾ç‰‡">
                    </td>
                </tr>
            </table>
            
            <table style="border: 2px solid #722ed1; margin: 10px 0; width: 100%;">
                <caption style="background: #f9f0ff; color: #722ed1; font-size: 16px; padding: 8px; border: 1px solid #d3adf7; border-radius: 4px; caption-side: top; margin-bottom: 5px;">
                    ğŸ¯ å¤æ‚æ ·å¼æ ‡é¢˜ - å¸¦èƒŒæ™¯å’Œè¾¹æ¡†
                </caption>
                <tr style="background: #fafafa;">
                    <td style="border: 1px solid #722ed1; padding: 10px; color: #fa541c;">å¤æ‚è¡¨æ ¼</td>
                    <td style="border: 1px solid #722ed1; padding: 10px;">
                        <img src="https://via.placeholder.com/40x40/722ed1/ffffff?text=ç´«" alt="ç´«è‰²å›¾ç‰‡">
                    </td>
                    <td style="border: 1px solid #722ed1; padding: 10px; color: #13c2c2;">æµ‹è¯•å†…å®¹</td>
                </tr>
            </table>
        </div>
        
        <button class="btn" onclick="copyContent('captionTest')">å¤åˆ¶è¡¨æ ¼æ ‡é¢˜æµ‹è¯•</button>
        
        <h3>ç²˜è´´åŒºåŸŸï¼š</h3>
        <div class="paste-area" contenteditable="true" id="pasteCaptions">
            ç‚¹å‡»è¿™é‡Œï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´...
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“‹ æ“ä½œè¯´æ˜</h2>
        <ol>
            <li><strong>é€‰æ‹©å†…å®¹</strong>ï¼šç”¨é¼ æ ‡é€‰ä¸­ä¸Šé¢ä»»ä¸€æµ‹è¯•åŒºåŸŸçš„å†…å®¹</li>
            <li><strong>å¤åˆ¶</strong>ï¼šæŒ‰ Ctrl+C æˆ–ç‚¹å‡»"å¤åˆ¶"æŒ‰é’®</li>
            <li><strong>ç²˜è´´</strong>ï¼šç‚¹å‡»å¯¹åº”çš„ç²˜è´´åŒºåŸŸï¼Œç„¶åæŒ‰ Ctrl+V</li>
            <li><strong>æ£€æŸ¥ç»“æœ</strong>ï¼šçœ‹çœ‹æ ¼å¼æ˜¯å¦ä¿æŒï¼Œå›¾ç‰‡æ˜¯å¦æˆåŠŸè½¬æ¢</li>
        </ol>
        
        <h3>æ£€æŸ¥é‡ç‚¹ï¼š</h3>
        <ul>
            <li>âœ… æ–‡å­—é¢œè‰²æ˜¯å¦ä¿æŒ</li>
            <li>âœ… å­—ä½“å¤§å°æ˜¯å¦æ­£ç¡®</li>
            <li>âœ… ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿æ˜¯å¦ä¿ç•™</li>
            <li>âœ… èƒŒæ™¯è‰²å’Œè¾¹æ¡†æ ·å¼æ˜¯å¦ä¿ç•™</li>
            <li>âœ… æ ‡é¢˜å±‚çº§æ˜¯å¦æ­£ç¡®</li>
            <li>âœ… è¡¨æ ¼å’Œåˆ—è¡¨ç»“æ„æ˜¯å¦å®Œæ•´</li>
            <li>âœ… <strong>è¡¨æ ¼æ ‡é¢˜(caption)æ˜¯å¦æ­£ç¡®æ˜¾ç¤º</strong> ğŸ†•</li>
            <li>âœ… è¡¨æ ¼æ ‡é¢˜çš„æ ·å¼(é¢œè‰²ã€å­—ä½“ã€ä½ç½®)æ˜¯å¦ä¿æŒ ğŸ†•</li>
            <li>âœ… å›¾ç‰‡æ˜¯å¦æ˜¾ç¤ºä¸”å·²è½¬æ¢ä¸ºå†…è”æ ¼å¼</li>
        </ul>
        
        <button class="btn" onclick="clearAllPasteAreas()">æ¸…ç©ºæ‰€æœ‰ç²˜è´´åŒºåŸŸ</button>
        <button class="btn" onclick="showClipboardInfo()">æŸ¥çœ‹å‰ªè´´æ¿ä¿¡æ¯</button>
        <button class="btn" onclick="testCaptionOnly()">ä»…æµ‹è¯•è¡¨æ ¼æ ‡é¢˜</button>
    </div>

    <script>
        function copyContent(elementId) {
            const element = document.getElementById(elementId);
            const selection = window.getSelection();
            const range = document.createRange();
            range.selectNodeContents(element);
            selection.removeAllRanges();
            selection.addRange(range);
            
            try {
                document.execCommand('copy');
                console.log('å¤åˆ¶æˆåŠŸ:', elementId);
            } catch (e) {
                console.error('å¤åˆ¶å¤±è´¥:', e);
            }
        }
        
        function testCaptionOnly() {
            console.log('=== ä¸“é—¨æµ‹è¯•è¡¨æ ¼æ ‡é¢˜ ===');
            
            // åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•è¡¨æ ¼
            const testTable = document.createElement('table');
            testTable.style.border = '1px solid #000';
            testTable.innerHTML = `
                <caption style="color: red; font-size: 18px; font-weight: bold;">æµ‹è¯•æ ‡é¢˜</caption>
                <tr><td style="border: 1px solid #ccc; padding: 5px;">æµ‹è¯•å†…å®¹</td></tr>
            `;
            
            document.body.appendChild(testTable);
            
            // é€‰æ‹©æ•´ä¸ªè¡¨æ ¼
            const selection = window.getSelection();
            const range = document.createRange();
            range.selectNode(testTable);
            selection.removeAllRanges();
            selection.addRange(range);
            
            // æ‰§è¡Œå¤åˆ¶
            document.execCommand('copy');
            console.log('è¡¨æ ¼æ ‡é¢˜æµ‹è¯•å¤åˆ¶å®Œæˆ');
            
            // æ¸…ç†
            document.body.removeChild(testTable);
        }
        
        function clearAllPasteAreas() {
            document.querySelectorAll('.paste-area').forEach(area => {
                area.innerHTML = 'ç‚¹å‡»è¿™é‡Œï¼Œç„¶åæŒ‰ Ctrl+V ç²˜è´´...';
            });
        }
        
        async function showClipboardInfo() {
            try {
                const clipboardItems = await navigator.clipboard.read();
                console.log('=== å‰ªè´´æ¿å†…å®¹åˆ†æ ===');
                
                for (const item of clipboardItems) {
                    console.log('å¯ç”¨ç±»å‹:', item.types);
                    
                    if (item.types.includes('text/html')) {
                        const htmlBlob = await item.getType('text/html');
                        const html = await htmlBlob.text();
                        console.log('HTMLé•¿åº¦:', html.length);
                        console.log('åŒ…å«data:imageæ•°é‡:', (html.match(/data:image/g) || []).length);
                        console.log('åŒ…å«httpå›¾ç‰‡æ•°é‡:', (html.match(/src="http/g) || []).length);
                        console.log('HTMLç‰‡æ®µ:', html.substring(0, 200) + '...');
                    }
                    
                    if (item.types.includes('text/plain')) {
                        const textBlob = await item.getType('text/plain');
                        const text = await textBlob.text();
                        console.log('çº¯æ–‡æœ¬é•¿åº¦:', text.length);
                        console.log('æ–‡æœ¬ç‰‡æ®µ:', text.substring(0, 100) + '...');
                    }
                }
            } catch (e) {
                console.error('æ— æ³•è¯»å–å‰ªè´´æ¿:', e);
            }
        }
        
        // ç›‘å¬ç²˜è´´äº‹ä»¶
        document.addEventListener('paste', (e) => {
            console.log('=== ç²˜è´´äº‹ä»¶è§¦å‘ ===');
            const htmlData = e.clipboardData?.getData('text/html');
            const textData = e.clipboardData?.getData('text/plain');
            
            if (htmlData) {
                console.log('ç²˜è´´HTMLé•¿åº¦:', htmlData.length);
                console.log('å†…è”å›¾ç‰‡æ•°é‡:', (htmlData.match(/src="data:image/g) || []).length);
                console.log('å¤–é“¾å›¾ç‰‡æ•°é‡:', (htmlData.match(/src="http/g) || []).length);
                
                // æ£€æŸ¥æ ·å¼ä¿æŒæƒ…å†µ
                const styleCount = (htmlData.match(/style="/g) || []).length;
                const colorCount = (htmlData.match(/color:/g) || []).length;
                const fontSizeCount = (htmlData.match(/font-size:/g) || []).length;
                
                console.log('æ ·å¼å±æ€§æ•°é‡:', styleCount);
                console.log('é¢œè‰²å±æ€§æ•°é‡:', colorCount);
                console.log('å­—ä½“å¤§å°å±æ€§æ•°é‡:', fontSizeCount);
            }
            
            if (textData) {
                console.log('ç²˜è´´æ–‡æœ¬é•¿åº¦:', textData.length);
            }
        });
        
        console.log('æ ¼å¼ä¿æŒæµ‹è¯•é¡µé¢å·²åŠ è½½');
    </script>
</body>
</html>
