<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•å›¾ç‰‡å¤åˆ¶æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-content {
            border: 2px solid #007acc;
            padding: 20px;
            margin: 20px 0;
            background-color: #f8f9fa;
        }
        .result-area {
            border: 2px dashed #28a745;
            padding: 20px;
            margin: 20px 0;
            min-height: 200px;
            background-color: #f8fff9;
        }
        .instructions {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        img {
            max-width: 150px;
            margin: 10px;
            vertical-align: middle;
        }
        .format-text {
            color: #dc3545;
            font-weight: bold;
            background-color: #fff3cd;
            padding: 5px;
            border-radius: 3px;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>å›¾ç‰‡å¤åˆ¶å†…è”åŒ–æµ‹è¯• - ç®€åŒ–ç‰ˆ</h1>
    
    <div class="instructions">
        <h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤ï¼š</h3>
        <ol>
            <li>ç¡®ä¿Chromeæ’ä»¶å·²å®‰è£…å¹¶åˆ·æ–°é¡µé¢</li>
            <li>é€‰æ‹©ä¸‹æ–¹è“è‰²æ¡†ä¸­çš„å…¨éƒ¨å†…å®¹ï¼ˆCtrl+Aæˆ–é¼ æ ‡æ‹–é€‰ï¼‰</li>
            <li>å¤åˆ¶å†…å®¹ï¼ˆCtrl+Cï¼‰</li>
            <li>ç­‰å¾…æ§åˆ¶å°æç¤º"å›¾ç‰‡è½¬æ¢å®Œæˆ"</li>
            <li>åœ¨ç»¿è‰²æ¡†ä¸­ç²˜è´´ï¼ˆCtrl+Vï¼‰</li>
            <li>æ£€æŸ¥æ ¼å¼å’Œå›¾ç‰‡æ˜¯å¦æ­£ç¡®æ˜¾ç¤º</li>
        </ol>
    </div>

    <div class="test-content" id="source">
        <h4>è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜</h4>
        <p>è¿™æ˜¯ä¸€æ®µåŒ…å«<span class="format-text">ç‰¹æ®Šæ ¼å¼</span>çš„æ–‡å­—ã€‚</p>
        <p>è¿™é‡Œæœ‰ä¸€å¼ å›¾ç‰‡ï¼š<img src="https://via.placeholder.com/100/ff0000/ffffff?text=RED" alt="çº¢è‰²å›¾ç‰‡"> å›¾ç‰‡åçš„æ–‡å­—ã€‚</p>
        <p>è¿˜æœ‰å¦ä¸€å¼ å›¾ç‰‡ï¼š<img src="https://via.placeholder.com/100/00ff00/ffffff?text=GREEN" alt="ç»¿è‰²å›¾ç‰‡"> ç»§ç»­æ–‡å­—å†…å®¹ã€‚</p>
        <p><strong>ç²—ä½“æ–‡å­—</strong>å’Œ<em>æ–œä½“æ–‡å­—</em>çš„ç»„åˆã€‚</p>
    </div>

    <div class="result-area" contenteditable="true">
        <p><em>åœ¨è¿™é‡Œç²˜è´´å†…å®¹...</em></p>
    </div>

    <div id="status"></div>

    <script>
        let copyCount = 0;
        const statusDiv = document.getElementById('status');

        function updateStatus(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
            statusDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }

        // ç›‘å¬é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'c') {
                copyCount++;
                updateStatus(`å¤åˆ¶æ“ä½œ #${copyCount} å¼€å§‹`);
                
                // æ£€æŸ¥é€‰ä¸­å†…å®¹
                const selection = window.getSelection();
                const selectedText = selection.toString();
                if (selectedText.length > 0) {
                    updateStatus(`é€‰ä¸­å†…å®¹é•¿åº¦: ${selectedText.length} å­—ç¬¦`);
                    
                    // æ£€æŸ¥æ˜¯å¦åŒ…å«å›¾ç‰‡
                    const range = selection.getRangeAt(0);
                    const fragment = range.cloneContents();
                    const images = fragment.querySelectorAll('img');
                    if (images.length > 0) {
                        updateStatus(`å‘ç° ${images.length} å¼ å›¾ç‰‡ï¼Œç­‰å¾…è½¬æ¢...`);
                    }
                }
            }
        });

        // ç›‘å¬å¤åˆ¶äº‹ä»¶
        document.addEventListener('copy', (e) => {
            updateStatus('æµè§ˆå™¨å¤åˆ¶äº‹ä»¶è§¦å‘');
        });

        // ç›‘å¬ç²˜è´´äº‹ä»¶
        document.addEventListener('paste', (e) => {
            updateStatus('ç²˜è´´äº‹ä»¶è§¦å‘');
            
            const htmlData = e.clipboardData?.getData('text/html');
            if (htmlData) {
                const dataUrlCount = (htmlData.match(/src="data:image/g) || []).length;
                const httpUrlCount = (htmlData.match(/src="http/g) || []).length;
                
                if (dataUrlCount > 0) {
                    updateStatus(`âœ… æˆåŠŸï¼šåŒ…å« ${dataUrlCount} ä¸ªdata URLå›¾ç‰‡`, 'success');
                } else if (httpUrlCount > 0) {
                    updateStatus(`âŒ å¤±è´¥ï¼šä»åŒ…å« ${httpUrlCount} ä¸ªHTTPå›¾ç‰‡é“¾æ¥`, 'error');
                } else {
                    updateStatus('æ— å›¾ç‰‡å†…å®¹');
                }
                
                // æ£€æŸ¥æ ¼å¼ä¿æŒ
                if (htmlData.includes('format-text') && htmlData.includes('background-color')) {
                    updateStatus('âœ… æ ¼å¼ä¿æŒï¼šCSSæ ·å¼å·²ä¿ç•™', 'success');
                } else {
                    updateStatus('âŒ æ ¼å¼ä¸¢å¤±ï¼šCSSæ ·å¼å¯èƒ½ä¸¢å¤±', 'error');
                }
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆ
        updateStatus('æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
    </script>
</body>
</html>
