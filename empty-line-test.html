<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç©ºè¡Œæ¸…ç†åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .test-content {
            border: 2px dashed #007acc;
            padding: 20px;
            margin: 15px 0;
            background-color: #f8f9fa;
            user-select: text;
            cursor: text;
        }
        
        .test-content h1 {
            color: #e74c3c;
            margin: 50px 0 40px 0;
        }
        
        .test-content h2 {
            color: #3498db;
            margin: 40px 0 30px 0;
        }
        
        .test-content p {
            margin: 30px 0;
        }
        
        .test-content .empty-para {
            height: 30px;
            background-color: #ffebee;
        }
        
        .test-content .empty-div {
            height: 25px;
            background-color: #e3f2fd;
        }
        
        .info-panel {
            background: #e8f4fd;
            border-left: 4px solid #007acc;
            padding: 15px;
            margin: 15px 0;
        }
        
        .config-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .config-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-primary {
            background: #007acc;
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .analysis-result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§¹ ç©ºè¡Œæ¸…ç†åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="info-panel">
            <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong><br>
            è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•ç©ºè¡Œæ¸…ç†åŠŸèƒ½ã€‚å½“ä½ å¤åˆ¶ä¸‹é¢çš„æµ‹è¯•å†…å®¹æ—¶ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨ï¼š
            <ul>
                <li>ğŸ—‘ï¸ ç§»é™¤ç©ºçš„æ®µè½å’Œdivå…ƒç´ </li>
                <li>ğŸ“ å‡å°‘å¤šä½™çš„æ¢è¡Œç¬¦</li>
                <li>ğŸ“ ç´§å‡‘è¿‡å¤§çš„é—´è·</li>
                <li>âœ¨ è®©å†…å®¹å˜å¾—æ›´ç´§å‡‘</li>
            </ul>
        </div>
        
        <div class="config-buttons">
            <button class="btn-primary" onclick="openConfig()">âš™ï¸ æ‰“å¼€é…ç½®ç•Œé¢</button>
            <button class="btn-secondary" onclick="testFunction()">ğŸ§ª æµ‹è¯•åŠŸèƒ½</button>
            <button class="btn-success" onclick="analyzeClipboard()">ğŸ“‹ åˆ†æå‰ªè´´æ¿</button>
        </div>
    </div>

    <div class="test-container">
        <h2>ğŸ“ æµ‹è¯•å†…å®¹ï¼ˆé€‰æ‹©å¹¶å¤åˆ¶ï¼‰</h2>
        
        <div class="test-content" id="testContent">
            <h1>è¿™æ˜¯ä¸€ä¸ªå¤§æ ‡é¢˜</h1>
            
            <p></p>
            <p></p>
            <p></p>
            
            <div></div>
            <div></div>
            
            <p>è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡å­—ï¼Œå‰é¢æœ‰å¾ˆå¤šç©ºè¡Œã€‚</p>
            
            <br>
            <br>
            <br>
            <br>
            <br>
            
            <h2>è¿™æ˜¯äºŒçº§æ ‡é¢˜</h2>
            
            <p></p>
            
            <p>è¿™æ˜¯ç¬¬äºŒæ®µæ–‡å­—ï¼Œä¸­é—´æœ‰å¾ˆå¤šæ¢è¡Œç¬¦ã€‚</p>
            
            <br>
            <br>
            <br>
            
            <div style="margin-top: 60px; margin-bottom: 80px;">
                è¿™ä¸ªdivæœ‰å¾ˆå¤§çš„è¾¹è·
            </div>
            
            <p style="margin-top: 100px; margin-bottom: 120px;">
                è¿™ä¸ªæ®µè½ä¹Ÿæœ‰å¾ˆå¤§çš„è¾¹è·
            </p>
            
            <p></p>
            <div></div>
            <p></p>
            
            <img src="https://via.placeholder.com/100x50/ff6b6b/ffffff?text=æµ‹è¯•å›¾ç‰‡" alt="æµ‹è¯•å›¾ç‰‡">
            
            <p>æœ€åä¸€æ®µæ–‡å­—ã€‚</p>
            
            <p></p>
            <p></p>
            <div></div>
        </div>
        
        <div class="info-panel">
            <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
            <ol>
                <li>é€‰æ‹©ä¸Šé¢è“è‰²æ¡†å†…çš„å…¨éƒ¨å†…å®¹</li>
                <li>æŒ‰ Ctrl+C å¤åˆ¶</li>
                <li>è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºçš„æ¸…ç†ä¿¡æ¯</li>
                <li>ç²˜è´´åˆ°å…¶ä»–åœ°æ–¹æŸ¥çœ‹æ•ˆæœ</li>
            </ol>
        </div>
    </div>

    <div class="test-container">
        <h2>âš™ï¸ é…ç½®æµ‹è¯•</h2>
        
        <div class="info-panel">
            <strong>é…ç½®é€‰é¡¹è¯´æ˜ï¼š</strong>
            <ul>
                <li><strong>ç§»é™¤ç©ºæ®µè½ï¼š</strong> åˆ é™¤æ²¡æœ‰å†…å®¹çš„ &lt;p&gt; æ ‡ç­¾</li>
                <li><strong>ç§»é™¤ç©ºdivï¼š</strong> åˆ é™¤æ²¡æœ‰å†…å®¹çš„ &lt;div&gt; æ ‡ç­¾</li>
                <li><strong>ç§»é™¤å¤šä½™æ¢è¡Œç¬¦ï¼š</strong> å°†è¿ç»­çš„ &lt;br&gt; æ ‡ç­¾å‡å°‘åˆ°æœ€å¤š2ä¸ª</li>
                <li><strong>ç´§å‡‘é—´è·ï¼š</strong> å‡å°‘è¿‡å¤§çš„marginå€¼</li>
            </ul>
        </div>
        
        <div class="config-buttons">
            <button class="btn-primary" onclick="enableAllCleanup()">âœ… å¯ç”¨å…¨éƒ¨æ¸…ç†</button>
            <button class="btn-secondary" onclick="disableAllCleanup()">âŒ ç¦ç”¨å…¨éƒ¨æ¸…ç†</button>
            <button class="btn-success" onclick="showCurrentConfig()">ğŸ“Š æ˜¾ç¤ºå½“å‰é…ç½®</button>
            <button class="btn-primary" onclick="testComplexReplacement()">ğŸ”„ æµ‹è¯•å¤æ‚æ›¿æ¢</button>
        </div>
        
        <div id="configDisplay" class="analysis-result" style="display: none;"></div>
    </div>

    <div class="test-container">
        <h2>ğŸ“Š å‰ªè´´æ¿åˆ†æ</h2>
        
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æ¥åˆ†æå‰ªè´´æ¿å†…å®¹ï¼š</p>
        
        <div class="config-buttons">
            <button class="btn-success" onclick="analyzeClipboard()">ğŸ” åˆ†æå‰ªè´´æ¿å†…å®¹</button>
            <button class="btn-secondary" onclick="clearAnalysis()">ğŸ—‘ï¸ æ¸…é™¤åˆ†æç»“æœ</button>
        </div>
        
        <div id="clipboardAnalysis" class="analysis-result" style="display: none;"></div>
    </div>

    <script>
        // æ‰“å¼€é…ç½®ç•Œé¢
        function openConfig() {
            if (typeof imageInlinerConfig !== 'undefined') {
                imageInlinerConfig.show();
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // æµ‹è¯•åŠŸèƒ½
        function testFunction() {
            if (typeof testImageInliner !== 'undefined') {
                testImageInliner();
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
                console.log('è¯·ç¡®ä¿æ’ä»¶å·²åŠ è½½ï¼Œç„¶ååœ¨æ§åˆ¶å°è¿è¡Œ testImageInliner()');
            }
        }

        // å¯ç”¨å…¨éƒ¨æ¸…ç†åŠŸèƒ½
        function enableAllCleanup() {
            if (typeof imageInlinerConfig !== 'undefined') {
                imageInlinerConfig.setEmptyLineConfig({
                    enabled: true,
                    removeEmptyParagraphs: true,
                    removeEmptyDivs: true,
                    removeExcessiveLineBreaks: true,
                    compactSpacing: true
                });
                console.log('âœ… å·²å¯ç”¨å…¨éƒ¨ç©ºè¡Œæ¸…ç†åŠŸèƒ½');
                alert('å·²å¯ç”¨å…¨éƒ¨ç©ºè¡Œæ¸…ç†åŠŸèƒ½');
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // ç¦ç”¨å…¨éƒ¨æ¸…ç†åŠŸèƒ½
        function disableAllCleanup() {
            if (typeof imageInlinerConfig !== 'undefined') {
                imageInlinerConfig.setEmptyLineConfig({
                    enabled: false
                });
                console.log('âŒ å·²ç¦ç”¨ç©ºè¡Œæ¸…ç†åŠŸèƒ½');
                alert('å·²ç¦ç”¨ç©ºè¡Œæ¸…ç†åŠŸèƒ½');
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // æ˜¾ç¤ºå½“å‰é…ç½®
        function showCurrentConfig() {
            if (typeof imageInlinerConfig !== 'undefined') {
                const headingConfig = imageInlinerConfig.getHeadingConfig();
                const emptyLineConfig = imageInlinerConfig.getEmptyLineConfig();
                
                const configText = `å½“å‰é…ç½®çŠ¶æ€ï¼š

ã€æ ‡é¢˜æ›¿æ¢é…ç½®ã€‘
å¯ç”¨çŠ¶æ€: ${headingConfig.enabled ? 'âœ… å·²å¯ç”¨' : 'âŒ æœªå¯ç”¨'}
æ›¿æ¢è§„åˆ™: ${JSON.stringify(headingConfig.replacements, null, 2)}

ã€ç©ºè¡Œæ¸…ç†é…ç½®ã€‘
å¯ç”¨çŠ¶æ€: ${emptyLineConfig.enabled ? 'âœ… å·²å¯ç”¨' : 'âŒ æœªå¯ç”¨'}
ç§»é™¤ç©ºæ®µè½: ${emptyLineConfig.removeEmptyParagraphs ? 'âœ…' : 'âŒ'}
ç§»é™¤ç©ºdiv: ${emptyLineConfig.removeEmptyDivs ? 'âœ…' : 'âŒ'}
ç§»é™¤å¤šä½™æ¢è¡Œ: ${emptyLineConfig.removeExcessiveLineBreaks ? 'âœ…' : 'âŒ'}
ç´§å‡‘é—´è·: ${emptyLineConfig.compactSpacing ? 'âœ…' : 'âŒ'}`;

                document.getElementById('configDisplay').style.display = 'block';
                document.getElementById('configDisplay').textContent = configText;
                
                console.log('ğŸ“Š å½“å‰é…ç½®:', { headingConfig, emptyLineConfig });
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // åˆ†æå‰ªè´´æ¿å†…å®¹
        async function analyzeClipboard() {
            try {
                const clipboardText = await navigator.clipboard.readText();
                
                // å°è¯•è¯»å–HTMLå†…å®¹
                let clipboardHTML = '';
                try {
                    const clipboardItems = await navigator.clipboard.read();
                    for (const item of clipboardItems) {
                        if (item.types.includes('text/html')) {
                            const htmlBlob = await item.getType('text/html');
                            clipboardHTML = await htmlBlob.text();
                        }
                    }
                } catch (e) {
                    console.log('æ— æ³•è¯»å–HTMLæ ¼å¼çš„å‰ªè´´æ¿å†…å®¹');
                }

                const analysis = `å‰ªè´´æ¿å†…å®¹åˆ†æï¼š

ã€æ–‡æœ¬å†…å®¹ã€‘
é•¿åº¦: ${clipboardText.length} å­—ç¬¦
è¡Œæ•°: ${clipboardText.split('\n').length} è¡Œ
ç©ºè¡Œæ•°: ${clipboardText.split('\n').filter(line => line.trim() === '').length} è¡Œ

ã€HTMLå†…å®¹ã€‘
${clipboardHTML ? `é•¿åº¦: ${clipboardHTML.length} å­—ç¬¦
åŒ…å«å›¾ç‰‡: ${clipboardHTML.includes('<img') ? 'âœ…' : 'âŒ'}
åŒ…å«è¡¨æ ¼: ${clipboardHTML.includes('<table') ? 'âœ…' : 'âŒ'}
åŒ…å«æ ‡é¢˜: ${(/h[1-6]/i.test(clipboardHTML)) ? 'âœ…' : 'âŒ'}
åŒ…å«ç©ºæ®µè½: ${clipboardHTML.includes('<p></p>') ? 'âœ…' : 'âŒ'}
åŒ…å«æ¢è¡Œç¬¦: ${clipboardHTML.includes('<br') ? 'âœ…' : 'âŒ'}` : 'æ— HTMLå†…å®¹'}

ã€æ–‡æœ¬å†…å®¹é¢„è§ˆã€‘
${clipboardText.substring(0, 500)}${clipboardText.length > 500 ? '...' : ''}

${clipboardHTML ? `ã€HTMLå†…å®¹é¢„è§ˆã€‘
${clipboardHTML.substring(0, 500)}${clipboardHTML.length > 500 ? '...' : ''}` : ''}`;

                document.getElementById('clipboardAnalysis').style.display = 'block';
                document.getElementById('clipboardAnalysis').textContent = analysis;
                
                console.log('ğŸ“‹ å‰ªè´´æ¿åˆ†æå®Œæˆ');
            } catch (err) {
                alert('æ— æ³•è®¿é—®å‰ªè´´æ¿: ' + err.message);
                console.error('å‰ªè´´æ¿è®¿é—®å¤±è´¥:', err);
            }
        }

        // æµ‹è¯•å¤æ‚æ ‡é¢˜æ›¿æ¢ï¼ˆä¿®å¤H1â†’H4â†’H5é—®é¢˜ï¼‰
        function testComplexReplacement() {
            if (typeof imageInlinerConfig !== 'undefined') {
                // è®¾ç½®å¤æ‚æ›¿æ¢è§„åˆ™
                imageInlinerConfig.setHeadingConfig({
                    enabled: true,
                    replacements: {
                        'h1': 'h4',  // H1 â†’ H4
                        'h4': 'h5',  // H4 â†’ H5
                        'h2': 'h2',  // å…¶ä»–ä¿æŒä¸å˜
                        'h3': 'h3',
                        'h5': 'h5',
                        'h6': 'h6'
                    }
                });
                
                console.log('âœ… å·²è®¾ç½®å¤æ‚æ›¿æ¢è§„åˆ™ï¼šH1â†’H4, H4â†’H5');
                alert('å·²è®¾ç½®å¤æ‚æ›¿æ¢è§„åˆ™ï¼šH1â†’H4, H4â†’H5\nè¯·å¤åˆ¶åŒ…å«H1å’ŒH4çš„å†…å®¹è¿›è¡Œæµ‹è¯•\nåŸå§‹H1åº”è¯¥åªå˜æˆH4ï¼ˆä¸æ˜¯H5ï¼‰');
                showCurrentConfig();
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // æ¸…é™¤åˆ†æç»“æœ
        function clearAnalysis() {
            document.getElementById('clipboardAnalysis').style.display = 'none';
            document.getElementById('configDisplay').style.display = 'none';
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            console.log('ğŸ§¹ ç©ºè¡Œæ¸…ç†æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š');
            console.log('1. é€‰æ‹©æµ‹è¯•å†…å®¹å¹¶å¤åˆ¶');
            console.log('2. æŸ¥çœ‹æ§åˆ¶å°çš„æ¸…ç†æ—¥å¿—');
            console.log('3. ä½¿ç”¨é…ç½®æŒ‰é’®æµ‹è¯•ä¸åŒè®¾ç½®');
            console.log('4. åˆ†æå‰ªè´´æ¿æŸ¥çœ‹æ¸…ç†æ•ˆæœ');
        });
    </script>
</body>
</html>
