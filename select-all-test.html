<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨é€‰å¤åˆ¶æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .info-panel {
            background: #e8f4fd;
            border-left: 4px solid #007acc;
            padding: 15px;
            margin: 15px 0;
        }
        
        .warning-panel {
            background: #fff7e6;
            border-left: 4px solid #ffa940;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success-panel {
            background: #f6ffed;
            border-left: 4px solid #52c41a;
            padding: 15px;
            margin: 15px 0;
        }
        
        .config-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .config-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-primary {
            background: #007acc;
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .analysis-result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        
        .content-area {
            background: #f8f9fa;
            border: 2px dashed #007acc;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }
        
        .kbd {
            background: #f5f5f5;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” å…¨é€‰å¤åˆ¶æµ‹è¯•ï¼ˆCtrl+A é—®é¢˜ä¿®å¤éªŒè¯ï¼‰</h1>
        
        <div class="warning-panel">
            <strong>âš ï¸ é—®é¢˜æè¿°ï¼š</strong><br>
            ä½¿ç”¨ Ctrl+A å…¨é€‰å¤åˆ¶æ—¶ï¼Œä¼šå¤šå‡ºä¸¤è¡Œä¸æƒ³è¦çš„å†…å®¹ï¼š
            <ul>
                <li>ğŸ–¼ï¸ ä¸€å¼ æµ‹è¯•å›¾ç‰‡ï¼ˆæ¥è‡ªæµ‹è¯•åŠŸèƒ½ï¼‰</li>
                <li>ğŸ“ ä¸€è¡Œé…ç½®ç›¸å…³çš„æ–‡å­—</li>
                <li>ğŸ”§ é…ç½®æŒ‰é’®</li>
            </ul>
        </div>
        
        <div class="success-panel">
            <strong>âœ… ä¿®å¤æ–¹æ¡ˆï¼š</strong><br>
            æ’ä»¶ç°åœ¨ä¼šè‡ªåŠ¨æ£€æµ‹å…¨é€‰æ“ä½œï¼ˆCtrl+Aï¼‰ï¼Œå¹¶åœ¨å¤åˆ¶æ—¶æ’é™¤ä»¥ä¸‹å…ƒç´ ï¼š
            <ul>
                <li>ğŸ—‘ï¸ é…ç½®æŒ‰é’®å’Œé…ç½®ç•Œé¢</li>
                <li>ğŸ—‘ï¸ æµ‹è¯•å†…å®¹å’Œæµ‹è¯•å›¾ç‰‡</li>
                <li>ğŸ—‘ï¸ æ’ä»¶ç›¸å…³çš„æ–‡å­—å’Œå…ƒç´ </li>
            </ul>
        </div>
        
        <div class="config-buttons">
            <button class="btn-primary" onclick="openConfig()">âš™ï¸ æ‰“å¼€é…ç½®ç•Œé¢</button>
            <button class="btn-secondary" onclick="testFunction()">ğŸ§ª è¿è¡Œæµ‹è¯•åŠŸèƒ½</button>
            <button class="btn-success" onclick="testSelectAll()">ğŸ“‹ æµ‹è¯•å…¨é€‰å¤åˆ¶</button>
            <button class="btn-warning" onclick="analyzeClipboard()">ğŸ” åˆ†æå‰ªè´´æ¿</button>
        </div>
    </div>

    <div class="test-container">
        <h2>ğŸ“ æµ‹è¯•æ­¥éª¤</h2>
        
        <div class="info-panel">
            <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong>
            <ol>
                <li>ğŸ”§ ç‚¹å‡»"æ‰“å¼€é…ç½®ç•Œé¢"æŒ‰é’®ï¼ˆä¼šåœ¨é¡µé¢æ·»åŠ é…ç½®ç•Œé¢ï¼‰</li>
                <li>ğŸ§ª ç‚¹å‡»"è¿è¡Œæµ‹è¯•åŠŸèƒ½"æŒ‰é’®ï¼ˆä¼šä¸´æ—¶æ·»åŠ æµ‹è¯•å†…å®¹ï¼‰</li>
                <li>ğŸ“‹ ç‚¹å‡»"æµ‹è¯•å…¨é€‰å¤åˆ¶"æˆ–ç›´æ¥æŒ‰ <span class="kbd">Ctrl+A</span> å…¨é€‰æ‰€æœ‰å†…å®¹</li>
                <li>ğŸ“ æŒ‰ <span class="kbd">Ctrl+C</span> å¤åˆ¶å†…å®¹</li>
                <li>ğŸ” ç‚¹å‡»"åˆ†æå‰ªè´´æ¿"æŸ¥çœ‹å¤åˆ¶çš„å†…å®¹</li>
                <li>âœ… éªŒè¯æ˜¯å¦è¿˜åŒ…å«ä¸æƒ³è¦çš„æ’ä»¶å…ƒç´ </li>
            </ol>
        </div>
        
        <div class="warning-panel">
            <strong>é¢„æœŸç»“æœï¼š</strong><br>
            â€¢ å¤åˆ¶çš„å†…å®¹ä¸­ä¸åº”åŒ…å«é…ç½®æŒ‰é’®<br>
            â€¢ å¤åˆ¶çš„å†…å®¹ä¸­ä¸åº”åŒ…å«æµ‹è¯•å›¾ç‰‡<br>
            â€¢ å¤åˆ¶çš„å†…å®¹ä¸­ä¸åº”åŒ…å«æ’ä»¶ç›¸å…³æ–‡å­—<br>
            â€¢ åªåŒ…å«é¡µé¢çš„æ­£å¸¸å†…å®¹
        </div>
    </div>

    <div class="test-container">
        <h2>ğŸ“Š é¡µé¢æ­£å¸¸å†…å®¹</h2>
        
        <div class="content-area">
            <h3>è¿™æ˜¯æ­£å¸¸çš„é¡µé¢å†…å®¹</h3>
            <p>è¿™äº›å†…å®¹åº”è¯¥è¢«æ­£å¸¸å¤åˆ¶ï¼š</p>
            
            <ul>
                <li>è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨é¡¹</li>
                <li>åŒ…å«ä¸€äº›<a href="#link">é“¾æ¥æ–‡å­—</a>çš„å†…å®¹</li>
                <li>è¿˜æœ‰ä¸€äº›<strong>ç²—ä½“æ–‡å­—</strong>å’Œ<em>æ–œä½“æ–‡å­—</em></li>
            </ul>
            
            <h4>å­æ ‡é¢˜ç¤ºä¾‹</h4>
            <p>è¿™æ˜¯ä¸€æ®µæ™®é€šçš„æ–‡å­—å†…å®¹ï¼Œåº”è¯¥ä¼šè¢«æ­£å¸¸å¤åˆ¶ã€‚è¿™é‡Œæœ‰ä¸€äº›<a href="https://example.com">å¤–éƒ¨é“¾æ¥</a>ã€‚</p>
            
            <blockquote>
                <p>è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—ï¼Œä¹Ÿåº”è¯¥è¢«æ­£å¸¸å¤åˆ¶ã€‚</p>
            </blockquote>
            
            <table border="1" style="border-collapse: collapse; margin: 10px 0;">
                <caption>è¡¨æ ¼æ ‡é¢˜ç¤ºä¾‹</caption>
                <tr>
                    <th>åˆ—1</th>
                    <th>åˆ—2</th>
                </tr>
                <tr>
                    <td>æ•°æ®1</td>
                    <td>æ•°æ®2</td>
                </tr>
            </table>
            
            <p>è¿™æ˜¯æœ€åä¸€æ®µæ–‡å­—ï¼Œç¡®ä¿æ‰€æœ‰æ­£å¸¸å†…å®¹éƒ½èƒ½è¢«å¤åˆ¶ã€‚</p>
        </div>
        
        <div class="info-panel">
            <strong>è¯´æ˜ï¼š</strong> ä¸Šé¢è“è‰²æ¡†å†…çš„å†…å®¹æ˜¯é¡µé¢çš„æ­£å¸¸å†…å®¹ï¼Œåº”è¯¥è¢«å®Œæ•´å¤åˆ¶ã€‚
        </div>
    </div>

    <div class="test-container">
        <h2>ğŸ“‹ å‰ªè´´æ¿åˆ†æç»“æœ</h2>
        
        <div class="config-buttons">
            <button class="btn-success" onclick="analyzeClipboard()">ğŸ” åˆ†æå‰ªè´´æ¿å†…å®¹</button>
            <button class="btn-secondary" onclick="clearAnalysis()">ğŸ—‘ï¸ æ¸…é™¤åˆ†æç»“æœ</button>
        </div>
        
        <div id="clipboardAnalysis" class="analysis-result" style="display: none;"></div>
    </div>

    <script>
        // æ‰“å¼€é…ç½®ç•Œé¢
        function openConfig() {
            if (typeof imageInlinerConfig !== 'undefined') {
                imageInlinerConfig.show();
                console.log('âœ… é…ç½®ç•Œé¢å·²æ‰“å¼€ï¼Œé¡µé¢ä¸Šä¼šä¸´æ—¶å‡ºç°é…ç½®ç•Œé¢');
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
            }
        }

        // æµ‹è¯•åŠŸèƒ½
        function testFunction() {
            if (typeof testImageInliner !== 'undefined') {
                testImageInliner();
                console.log('âœ… æµ‹è¯•åŠŸèƒ½å·²è¿è¡Œï¼Œé¡µé¢ä¸Šä¼šä¸´æ—¶å‡ºç°æµ‹è¯•å†…å®¹');
            } else {
                alert('è¯·å…ˆåŠ è½½æ’ä»¶å†…å®¹è„šæœ¬');
                console.log('è¯·ç¡®ä¿æ’ä»¶å·²åŠ è½½ï¼Œç„¶ååœ¨æ§åˆ¶å°è¿è¡Œ testImageInliner()');
            }
        }

        // æµ‹è¯•å…¨é€‰å¤åˆ¶
        function testSelectAll() {
            // æ¨¡æ‹Ÿå…¨é€‰æ“ä½œ
            const selection = window.getSelection();
            const range = document.createRange();
            range.selectNodeContents(document.body);
            selection.removeAllRanges();
            selection.addRange(range);
            
            console.log('âœ… å·²æ‰§è¡Œå…¨é€‰æ“ä½œï¼Œè¯·æŒ‰ Ctrl+C å¤åˆ¶å†…å®¹');
            alert('å·²æ‰§è¡Œå…¨é€‰æ“ä½œ\nè¯·æŒ‰ Ctrl+C å¤åˆ¶å†…å®¹\nç„¶åç‚¹å‡»"åˆ†æå‰ªè´´æ¿"æŸ¥çœ‹ç»“æœ');
        }

        // åˆ†æå‰ªè´´æ¿å†…å®¹
        async function analyzeClipboard() {
            try {
                const clipboardText = await navigator.clipboard.readText();
                
                // å°è¯•è¯»å–HTMLå†…å®¹
                let clipboardHTML = '';
                try {
                    const clipboardItems = await navigator.clipboard.read();
                    for (const item of clipboardItems) {
                        if (item.types.includes('text/html')) {
                            const htmlBlob = await item.getType('text/html');
                            clipboardHTML = await htmlBlob.text();
                        }
                    }
                } catch (e) {
                    console.log('æ— æ³•è¯»å–HTMLæ ¼å¼çš„å‰ªè´´æ¿å†…å®¹');
                }

                // æ£€æŸ¥æ˜¯å¦åŒ…å«ä¸æƒ³è¦çš„å†…å®¹
                const hasConfigButton = clipboardHTML.includes('imageInlinerConfigBtn') || 
                                       clipboardHTML.includes('data-image-inliner-config') ||
                                       clipboardHTML.includes('å›¾ç‰‡å†…è”æ’ä»¶è®¾ç½®');
                
                const hasTestContent = clipboardHTML.includes('data-image-inliner-test') ||
                                      clipboardHTML.includes('æµ‹è¯•æ ‡é¢˜1') ||
                                      clipboardHTML.includes('æµ‹è¯•æ ‡é¢˜2');
                
                const hasConfigUI = clipboardHTML.includes('headingConfigUI') ||
                                   clipboardHTML.includes('å†…å®¹å¤„ç†è®¾ç½®');
                
                const hasPluginText = clipboardText.includes('testImageInliner') ||
                                     clipboardText.includes('imageInlinerConfig') ||
                                     clipboardText.includes('å›¾ç‰‡å†…è”è½¬æ¢æ’ä»¶');

                // åˆ†æç»“æœ
                const analysis = `å‰ªè´´æ¿å†…å®¹åˆ†æï¼š

ã€åŸºæœ¬ä¿¡æ¯ã€‘
æ–‡æœ¬é•¿åº¦: ${clipboardText.length} å­—ç¬¦
HTMLé•¿åº¦: ${clipboardHTML.length} å­—ç¬¦
è¡Œæ•°: ${clipboardText.split('\n').length} è¡Œ

ã€æ’ä»¶å…ƒç´ æ£€æŸ¥ã€‘
åŒ…å«é…ç½®æŒ‰é’®: ${hasConfigButton ? 'âŒ æ˜¯' : 'âœ… å¦'}
åŒ…å«æµ‹è¯•å†…å®¹: ${hasTestContent ? 'âŒ æ˜¯' : 'âœ… å¦'}
åŒ…å«é…ç½®ç•Œé¢: ${hasConfigUI ? 'âŒ æ˜¯' : 'âœ… å¦'}
åŒ…å«æ’ä»¶æ–‡å­—: ${hasPluginText ? 'âŒ æ˜¯' : 'âœ… å¦'}

ã€ä¿®å¤æ•ˆæœè¯„ä¼°ã€‘
${!hasConfigButton && !hasTestContent && !hasConfigUI && !hasPluginText ? 
'âœ… ä¿®å¤æˆåŠŸï¼æ²¡æœ‰æ£€æµ‹åˆ°æ’ä»¶æ·»åŠ çš„å…ƒç´ ' : 
'âš ï¸ ä»æœ‰æ’ä»¶å…ƒç´ è¢«å¤åˆ¶ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥'}

ã€å†…å®¹é¢„è§ˆã€‘
${clipboardText.substring(0, 800)}${clipboardText.length > 800 ? '\n...' : ''}

${clipboardHTML ? `ã€HTMLå†…å®¹å…³é”®è¯æ£€æŸ¥ã€‘
é…ç½®æŒ‰é’®ID: ${clipboardHTML.includes('imageInlinerConfigBtn') ? 'âŒ å­˜åœ¨' : 'âœ… ä¸å­˜åœ¨'}
æµ‹è¯•å†…å®¹æ ‡è®°: ${clipboardHTML.includes('data-image-inliner-test') ? 'âŒ å­˜åœ¨' : 'âœ… ä¸å­˜åœ¨'}
é…ç½®ç•Œé¢ID: ${clipboardHTML.includes('headingConfigUI') ? 'âŒ å­˜åœ¨' : 'âœ… ä¸å­˜åœ¨'}` : ''}`;

                document.getElementById('clipboardAnalysis').style.display = 'block';
                document.getElementById('clipboardAnalysis').textContent = analysis;
                
                console.log('ğŸ“‹ å‰ªè´´æ¿åˆ†æå®Œæˆ');
                
                // åœ¨æ§åˆ¶å°æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                console.log('è¯¦ç»†åˆ†æç»“æœ:', {
                    hasConfigButton,
                    hasTestContent,
                    hasConfigUI,
                    hasPluginText,
                    textLength: clipboardText.length,
                    htmlLength: clipboardHTML.length
                });
                
            } catch (err) {
                alert('æ— æ³•è®¿é—®å‰ªè´´æ¿: ' + err.message);
                console.error('å‰ªè´´æ¿è®¿é—®å¤±è´¥:', err);
            }
        }

        // æ¸…é™¤åˆ†æç»“æœ
        function clearAnalysis() {
            document.getElementById('clipboardAnalysis').style.display = 'none';
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            console.log('ğŸ” å…¨é€‰å¤åˆ¶æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('ğŸ’¡ æµ‹è¯•è¯´æ˜ï¼š');
            console.log('1. å…ˆç‚¹å‡»é…ç½®å’Œæµ‹è¯•æŒ‰é’®æ·»åŠ æ’ä»¶å…ƒç´ ');
            console.log('2. ä½¿ç”¨ Ctrl+A å…¨é€‰æ‰€æœ‰å†…å®¹');
            console.log('3. ä½¿ç”¨ Ctrl+C å¤åˆ¶å†…å®¹');
            console.log('4. åˆ†æå‰ªè´´æ¿éªŒè¯æ˜¯å¦æ’é™¤äº†æ’ä»¶å…ƒç´ ');
        });
    </script>
</body>
</html>
